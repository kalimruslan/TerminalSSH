# Техническое задание: TerminalSSH

## 1. Общие сведения

**Название продукта:** TerminalSSH
**Тип приложения:** Мобильный SSH-клиент для Android
**Целевая платформа:** Android 7.0+ (API 24) — Android 15 (API 36)
**Версия документа:** 1.0
**Дата создания:** Декабрь 2025

---

## 2. Описание продукта

### 2.1 Назначение

TerminalSSH — мобильное приложение для удалённого управления серверами и сетевым оборудованием через защищённый протокол SSH. Приложение позволяет системным администраторам, DevOps-инженерам и разработчикам выполнять команды на удалённых серверах непосредственно с Android-устройства.

### 2.2 Краткое описание

Приложение предоставляет полнофункциональный SSH-терминал с возможностью сохранения подключений, управления избранными командами и удобным Material Design 3 интерфейсом. Ключевой фокус — простота использования и быстрый доступ к часто используемым серверам.

---

## 3. Проблемы, которые решает приложение

### 3.1 Проблема: Отсутствие доступа к серверам в мобильном режиме

**Описание проблемы:**
Системные администраторы и разработчики часто сталкиваются с необходимостью экстренного доступа к серверам вне офиса — во время командировок, в транспорте, на совещаниях. Использование ноутбука не всегда возможно или удобно.

**Решение TerminalSSH:**
- Полнофункциональный SSH-клиент в кармане
- Мгновенный доступ к серверам с любого Android-устройства
- Работа в любых условиях — требуется только интернет-соединение

### 3.2 Проблема: Рутинный повторный ввод данных подключения

**Описание проблемы:**
При частом подключении к одним и тем же серверам приходится каждый раз вводить хост, порт, логин и пароль. Это отнимает время и повышает вероятность ошибки.

**Решение TerminalSSH:**
- Сохранение подключений в локальную базу данных
- Быстрый выбор сервера из списка сохранённых
- Автоматическое отслеживание последних использованных подключений
- Сортировка по частоте использования — нужные серверы всегда наверху

### 3.3 Проблема: Запоминание и повторный ввод команд

**Описание проблемы:**
DevOps-инженеры и администраторы регулярно выполняют одни и те же команды: перезапуск сервисов, проверка логов, мониторинг ресурсов. Ручной ввод длинных команд на мобильном устройстве неудобен и занимает много времени.

**Решение TerminalSSH:**
- Система избранных команд для каждого подключения
- Один тап — команда вставлена в терминал
- Возможность добавить описание к сохранённой команде
- Специфичные команды для каждого сервера отдельно

### 3.4 Проблема: Неудобный интерфейс существующих SSH-клиентов

**Описание проблемы:**
Многие мобильные SSH-клиенты имеют устаревший или перегруженный интерфейс, что затрудняет работу, особенно в стрессовых ситуациях.

**Решение TerminalSSH:**
- Современный интерфейс на основе Material Design 3
- Интуитивно понятная навигация
- Цветовая схема терминала, оптимизированная для чтения (VS Code Dark)
- Чёткое разделение команд, вывода и ошибок по цвету
- Поддержка Dynamic Colors на Android 12+

### 3.5 Проблема: Сложность быстрого реагирования на инциденты

**Описание проблемы:**
При возникновении аварийной ситуации на сервере важна скорость реакции. Каждая минута простоя может стоить денег и репутации.

**Решение TerminalSSH:**
- Быстрое подключение к сохранённому серверу в 2 тапа
- Мгновенный доступ к избранным командам для устранения типовых проблем
- Автоскролл вывода для отслеживания выполнения в реальном времени

---

## 4. Целевая аудитория

### 4.1 Основные пользователи

| Роль | Сценарии использования |
|------|------------------------|
| **Системные администраторы** | Мониторинг серверов, перезапуск сервисов, анализ логов, управление пользователями |
| **DevOps-инженеры** | Деплой приложений, управление контейнерами, настройка CI/CD, работа с Kubernetes |
| **Backend-разработчики** | Отладка приложений на production, просмотр логов, проверка конфигурации |
| **Сетевые инженеры** | Настройка маршрутизаторов и коммутаторов через SSH |
| **Студенты IT-специальностей** | Изучение работы с серверами, выполнение лабораторных работ |

### 4.2 Портрет типичного пользователя

**Технически грамотный специалист**, который:
- Работает с Linux/Unix серверами на регулярной основе
- Имеет несколько серверов под управлением
- Нуждается в удалённом доступе вне рабочего места
- Ценит скорость и удобство инструментов

---

## 5. Функциональные требования

### 5.1 Модуль SSH-подключения

| ID | Требование | Приоритет |
|----|------------|-----------|
| SSH-001 | Подключение к SSH-серверу по протоколу SSH-2 | Высокий |
| SSH-002 | Аутентификация по логину и паролю | Высокий |
| SSH-003 | Поддержка нестандартных портов (не только 22) | Высокий |
| SSH-004 | Отображение состояния подключения (подключение/подключён/ошибка/отключён) | Высокий |
| SSH-005 | Корректное закрытие соединения при выходе | Высокий |
| SSH-006 | Обработка ошибок подключения с понятными сообщениями | Высокий |

### 5.2 Модуль терминала

| ID | Требование | Приоритет |
|----|------------|-----------|
| TERM-001 | Ввод и отправка команд на сервер | Высокий |
| TERM-002 | Отображение вывода команд в реальном времени | Высокий |
| TERM-003 | Цветовое кодирование: команды, вывод, ошибки | Средний |
| TERM-004 | Автоматический скролл к последней строке | Средний |
| TERM-005 | Поддержка многострочного ввода команд | Средний |
| TERM-006 | Очистка ANSI escape-последовательностей | Высокий |
| TERM-007 | Буферизация вывода для оптимизации производительности | Высокий |
| TERM-008 | Ограничение истории вывода (100 строк) для экономии памяти | Средний |

### 5.3 Модуль управления подключениями

| ID | Требование | Приоритет |
|----|------------|-----------|
| CONN-001 | Сохранение подключений в локальную базу данных | Высокий |
| CONN-002 | Отображение списка сохранённых подключений | Высокий |
| CONN-003 | Быстрый выбор подключения из списка | Высокий |
| CONN-004 | Удаление сохранённых подключений | Высокий |
| CONN-005 | Сортировка по времени последнего использования | Средний |
| CONN-006 | Автогенерация имени подключения (user@host) | Низкий |
| CONN-007 | Обновление времени последнего использования | Средний |

### 5.4 Модуль избранных команд

| ID | Требование | Приоритет | Статус |
|----|------------|-----------|--------|
| FAV-001 | Добавление команды в избранное | Высокий | ✅ |
| FAV-002 | Удаление команды из избранного | Высокий | ✅ |
| FAV-003 | Отображение списка избранных команд для подключения | Высокий | ✅ |
| FAV-004 | Быстрая вставка избранной команды в поле ввода | Высокий | ✅ |
| FAV-005 | Привязка избранных команд к конкретному подключению | Средний | ✅ |
| FAV-006 | Добавление описания к избранной команде | Низкий | ✅ |
| FAV-007 | Индикация статуса избранного для текущей команды | Средний | ✅ |

### 5.5 Модуль истории команд

| ID | Требование | Приоритет | Статус |
|----|------------|-----------|--------|
| HIST-001 | Сохранение выполненных команд в локальную БД | Высокий | ✅ |
| HIST-002 | Навигация по истории кнопками вверх/вниз | Высокий | ✅ |
| HIST-003 | Ограничение размера истории (500 команд) | Средний | ✅ |
| HIST-004 | Привязка истории к подключению | Средний | ✅ |

### 5.6 Модуль настроек

| ID | Требование | Приоритет | Статус |
|----|------------|-----------|--------|
| SET-001 | Выбор размера шрифта терминала (10-24 sp) | Средний | ✅ |
| SET-002 | Выбор цветовой схемы (Dark, Light, Solarized, Monokai) | Средний | ✅ |
| SET-003 | Сохранение настроек в DataStore Preferences | Высокий | ✅ |
| SET-004 | Применение настроек в реальном времени | Средний | ✅ |

### 5.7 Модуль SFTP (Файловый браузер)

| ID | Требование | Приоритет | Статус |
|----|------------|-----------|--------|
| SFTP-001 | Открытие SFTP канала через существующее SSH соединение | Высокий | ✅ |
| SFTP-002 | Отображение списка файлов и папок | Высокий | ✅ |
| SFTP-003 | Навигация по директориям | Высокий | ✅ |
| SFTP-004 | Breadcrumb-навигация по пути | Средний | ✅ |
| SFTP-005 | Демо-режим с виртуальной файловой системой | Средний | ✅ |
| SFTP-006 | Отображение размера и прав доступа файлов | Низкий | ✅ |
| SFTP-007 | Создание директорий | Средний | ⏳ |
| SFTP-008 | Удаление файлов и директорий | Средний | ⏳ |
| SFTP-009 | Скачивание файлов | Средний | ⏳ |
| SFTP-010 | Загрузка файлов | Средний | ⏳ |

---

## 6. Нефункциональные требования

### 6.1 Производительность

| ID | Требование |
|----|------------|
| PERF-001 | Время подключения к серверу: не более 5 секунд в стандартных условиях |
| PERF-002 | Задержка отображения вывода: не более 100 мс |
| PERF-003 | Плавный скролл терминала (60 FPS) |
| PERF-004 | Потребление оперативной памяти: не более 150 МБ |

### 6.2 Надёжность

| ID | Требование |
|----|------------|
| REL-001 | Корректная работа при потере и восстановлении сети |
| REL-002 | Сохранение данных при неожиданном закрытии приложения |
| REL-003 | Отсутствие утечек памяти при длительной работе |
| REL-004 | Корректная работа в фоновом режиме |

### 6.3 Безопасность

| ID | Требование |
|----|------------|
| SEC-001 | Шифрование соединения по протоколу SSH-2 |
| SEC-002 | Безопасное хранение паролей (шифрование данных приложения) |
| SEC-003 | Отсутствие передачи данных третьим сторонам |
| SEC-004 | Защита данных приложения через Android backup rules |

### 6.4 Совместимость

| ID | Требование |
|----|------------|
| COMP-001 | Поддержка Android 7.0 (API 24) и выше |
| COMP-002 | Адаптация под различные размеры экранов |
| COMP-003 | Поддержка светлой и тёмной темы |
| COMP-004 | Поддержка Dynamic Colors на Android 12+ |

---

## 7. Конкурентные преимущества

### 7.1 Сравнение с конкурентами

| Критерий | TerminalSSH | Конкурент A | Конкурент B |
|----------|-------------|-------------|-------------|
| Modern UI (Material 3) | ✅ | ❌ | ⚠️ |
| Избранные команды | ✅ | ❌ | ⚠️ |
| Бесплатно | ✅ | ⚠️ | ❌ |
| Без рекламы | ✅ | ❌ | ⚠️ |
| Офлайн хранение подключений | ✅ | ✅ | ✅ |
| Dynamic Colors | ✅ | ❌ | ❌ |

### 7.2 Ключевые преимущества

1. **Современный стек технологий**
   - Jetpack Compose для нативного, отзывчивого UI
   - Clean Architecture для поддерживаемости кода
   - Kotlin Coroutines для эффективной асинхронности

2. **Фокус на пользовательском опыте**
   - Минималистичный интерфейс без лишних элементов
   - Быстрый доступ к частым операциям
   - Интуитивно понятная навигация

3. **Система избранных команд**
   - Уникальная функция для мобильных SSH-клиентов
   - Экономит время на вводе повторяющихся команд
   - Привязка к конкретным серверам

4. **Оптимизация для мобильных устройств**
   - Буферизация вывода для экономии батареи
   - Ограничение истории для экономии памяти
   - Адаптивный интерфейс

---

## 8. Архитектура приложения

### 8.1 Общая архитектура

```
┌─────────────────────────────────────────────────────────────┐
│                    Presentation Layer                        │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │ ConnectScreen│  │TerminalScreen│  │     ViewModels     │  │
│  └─────────────┘  └─────────────┘  │   (MVI Pattern)     │  │
│                                     └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      Domain Layer                            │
│  ┌─────────────────────────────────────────────────────┐    │
│  │                    Use Cases                         │    │
│  │  • ConnectSsh      • GetSavedConnections            │    │
│  │  • DisconnectSsh   • SaveConnection                 │    │
│  │  • ExecuteCommand  • DeleteConnection               │    │
│  │  • AddToFavorites  • RemoveFromFavorites            │    │
│  └─────────────────────────────────────────────────────┘    │
│  ┌─────────────────────────────────────────────────────┐    │
│  │              Repository Interfaces                   │    │
│  └─────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                       Data Layer                             │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │
│  │  SSH Client │  │  Room DB    │  │   Repositories      │  │
│  │ (MINA SSHD) │  │             │  │   Implementation    │  │
│  └─────────────┘  └─────────────┘  └─────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
```

### 8.2 Модульная структура

```
TerminalSSH/
├── app/                    # Главный модуль приложения
├── core/
│   ├── theme/              # Material Design 3 тема + цветовые схемы терминала
│   └── common/             # Общие утилиты, DI, Result wrapper
├── domain/                 # Бизнес-логика (Use Cases, интерфейсы, модели)
├── data/                   # Реализация данных (Room, DataStore, SSH/SFTP)
│   ├── database/           # Room база данных
│   ├── ssh/                # SSH клиент (Apache MINA SSHD)
│   ├── sftp/               # SFTP клиент
│   ├── security/           # Шифрование паролей (Android Keystore)
│   └── repository/         # Реализации репозиториев
└── feature/
    ├── connect/            # Экран подключения
    ├── terminal/           # SSH терминал
    ├── settings/           # Настройки приложения
    └── sftp/               # Файловый браузер SFTP
```

### 8.3 Технологический стек

| Компонент | Технология |
|-----------|------------|
| UI Framework | Jetpack Compose |
| Design System | Material Design 3 |
| Иконки | Material Icons Extended |
| Архитектура | Clean Architecture + MVI |
| DI | Hilt (Dagger) |
| База данных | Room 2.6.1 |
| Настройки | DataStore Preferences 1.1.1 |
| SSH | Apache MINA SSHD Core 2.14.0 |
| SFTP | Apache MINA SSHD SFTP 2.14.0 |
| Шифрование | Android Keystore (AES-256-GCM) |
| Асинхронность | Kotlin Coroutines 1.9.0 + Flow |
| Навигация | Navigation Compose 2.8.4 |
| Язык | Kotlin 2.0.21 |

---

## 9. Пользовательские сценарии (User Stories)

### US-001: Первое подключение к серверу

**Как** системный администратор,
**Я хочу** подключиться к своему серверу,
**Чтобы** выполнить необходимые команды.

**Критерии приёмки:**
- Могу ввести хост, порт, логин и пароль
- Вижу индикатор процесса подключения
- При успешном подключении открывается терминал
- При ошибке вижу понятное сообщение

### US-002: Сохранение подключения

**Как** пользователь с несколькими серверами,
**Я хочу** сохранить данные подключения,
**Чтобы** не вводить их каждый раз заново.

**Критерии приёмки:**
- Могу отметить "Сохранить подключение" перед подключением
- Могу задать понятное имя для подключения
- Подключение появляется в списке сохранённых

### US-003: Быстрое переподключение

**Как** пользователь с сохранёнными подключениями,
**Я хочу** быстро подключиться к нужному серверу,
**Чтобы** сэкономить время.

**Критерии приёмки:**
- Вижу список сохранённых подключений на главном экране
- Недавно использованные подключения отображаются первыми
- При выборе подключения поля заполняются автоматически

### US-004: Выполнение команды

**Как** подключённый пользователь,
**Я хочу** выполнить команду на сервере,
**Чтобы** получить результат.

**Критерии приёмки:**
- Могу ввести команду в поле ввода
- Команда отправляется при нажатии кнопки отправки
- Вижу вывод команды в терминале
- Вывод команды визуально отличается от самой команды

### US-005: Сохранение команды в избранное

**Как** пользователь с повторяющимися задачами,
**Я хочу** сохранить часто используемую команду,
**Чтобы** не вводить её каждый раз вручную.

**Критерии приёмки:**
- Могу добавить текущую команду в избранное одним нажатием
- Избранная команда привязана к текущему подключению
- Вижу индикатор, что команда уже в избранном

### US-006: Использование избранной команды

**Как** пользователь с сохранёнными командами,
**Я хочу** быстро вставить избранную команду,
**Чтобы** выполнить её без ручного ввода.

**Критерии приёмки:**
- Могу открыть список избранных команд
- При выборе команда вставляется в поле ввода
- Могу отредактировать команду перед выполнением

---

## 10. Экраны приложения

### 10.1 Экран подключения (ConnectScreen)

```
┌─────────────────────────────────────┐
│           TerminalSSH               │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │ Host                        │   │
│  │ example.com                 │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ Port                        │   │
│  │ 22                          │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ Username                    │   │
│  │ admin                       │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ Password                    │   │
│  │ ••••••••                    │   │
│  └─────────────────────────────┘   │
│                                     │
│  ☑ Save connection                  │
│  ┌─────────────────────────────┐   │
│  │ Connection name             │   │
│  │ Production Server           │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │         CONNECT             │   │
│  └─────────────────────────────┘   │
│                                     │
│  ─────── Saved Connections ─────── │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 🖥 Production Server     🗑 │   │
│  │   admin@prod.example.com    │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 🖥 Dev Server            🗑 │   │
│  │   dev@192.168.1.100         │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

### 10.2 Экран терминала (TerminalScreen)

```
┌─────────────────────────────────────┐
│  ← Terminal              [EXIT]     │
├─────────────────────────────────────┤
│                                     │
│  ▼ Favorites (3)                    │
│                                     │
│  ┌─────────────────────────────────┐│
│  │ $ ls -la                        ││
│  │ total 48                        ││
│  │ drwxr-xr-x  2 root root  4096   ││
│  │ -rw-r--r--  1 root root  1234   ││
│  │                                 ││
│  │ $ systemctl status nginx        ││
│  │ ● nginx.service - nginx         ││
│  │   Loaded: loaded                ││
│  │   Active: active (running)      ││
│  │                                 ││
│  │ $ df -h                         ││
│  │ Filesystem  Size  Used Avail    ││
│  │ /dev/sda1   50G   12G   38G     ││
│  │                                 ││
│  └─────────────────────────────────┘│
│                                     │
│  ┌─────────────────────────┐ ☆ ➤  │
│  │ $ _                     │       │
│  └─────────────────────────┘       │
│                                     │
└─────────────────────────────────────┘
```

---

## 11. Потенциальные направления развития

### 11.1 Реализовано ✅

1. **История команд** ✅
   - Сохранение выполненных команд в Room БД
   - Навигация по истории (кнопки вверх/вниз)
   - Ограничение размера (500 команд)

2. **Настройки терминала** ✅
   - Выбор размера шрифта (10-24 sp)
   - Выбор цветовой схемы (Dark, Light, Solarized Dark, Monokai)
   - Сохранение в DataStore Preferences

3. **SFTP-клиент (базовый)** ✅
   - Просмотр файловой системы сервера
   - Навигация по директориям
   - Демо-режим с виртуальной ФС

4. **Безопасность** ✅
   - Шифрование паролей через Android Keystore (AES-256-GCM)
   - Поддержка legacy паролей

### 11.2 Краткосрочные улучшения

1. **Аутентификация по SSH-ключам**
   - Импорт приватных ключей
   - Генерация ключей в приложении
   - Поддержка passphrase

2. **SFTP CRUD операции**
   - Скачивание и загрузка файлов
   - Создание и удаление файлов/директорий

3. **Биометрическая аутентификация**
   - Разблокировка паролей по отпечатку/Face ID

### 11.3 Среднесрочные улучшения

1. **Port Forwarding**
   - Local port forwarding
   - Remote port forwarding
   - Dynamic (SOCKS) forwarding

2. **Множественные сессии**
   - Несколько вкладок терминала
   - Быстрое переключение между серверами

3. **Экспорт/импорт подключений**
   - Резервное копирование настроек
   - Перенос между устройствами

### 11.3 Долгосрочные улучшения

1. **Синхронизация через облако**
   - Синхронизация подключений между устройствами
   - End-to-end шифрование

2. **Автоматизация**
   - Создание скриптов из избранных команд
   - Планировщик выполнения команд
   - Уведомления о результатах

3. **Интеграции**
   - Поддержка Mosh для нестабильных соединений
   - Интеграция с менеджерами паролей
   - Виджеты для быстрого доступа

---

## 12. Метрики успеха

### 12.1 Пользовательские метрики

| Метрика | Целевое значение |
|---------|------------------|
| Время до первого подключения | < 30 секунд |
| Время подключения к сохранённому серверу | < 5 секунд |
| Коэффициент использования избранных команд | > 40% от всех команд |
| Retention Day 7 | > 30% |
| Retention Day 30 | > 15% |

### 12.2 Технические метрики

| Метрика | Целевое значение |
|---------|------------------|
| Crash-free rate | > 99.5% |
| ANR rate | < 0.1% |
| Средний размер APK | < 15 MB |
| Время холодного запуска | < 2 секунды |

---

## 13. Заключение

TerminalSSH — это современное, удобное и функциональное приложение для удалённого управления серверами через SSH. Приложение решает ключевые проблемы целевой аудитории:

- **Мобильность** — доступ к серверам с любого места
- **Скорость** — быстрое подключение через сохранённые данные
- **Эффективность** — избранные команды экономят время
- **Удобство** — современный интуитивный интерфейс

Архитектура приложения позволяет легко расширять функциональность и поддерживать код в долгосрочной перспективе. Clean Architecture и модульная структура обеспечивают тестируемость и масштабируемость.